# Workers Pool

## Описание проекта

**Workers Pool** — это веб-приложение, разработанное с использованием фреймворка **Quasar** (на базе Vue.js), сборщика **Vite** и менеджера состояний **Pinia**. Проект демонстрирует использование **Web Workers** для выполнения асинхронных задач в пуле воркеров с очередью задач. В приложении реализованы три типа воркеров:

1. **HTTP-воркер**: выполняет HTTP-запросы (GET/POST) к сторонним API с поддержкой базовой аутентификации.
2. **Compute-воркер (JS)**: выполняет вычисление факториала числа, реализованное на JavaScript.
3. **WASM Compute-воркер (Rust)**: выполняет вычисление факториала числа с использованием WebAssembly, скомпилированного из Rust, для демонстрации высокой производительности по сравнению с JavaScript.

Проект демонстрирует управление пулом воркеров, обработку очередей задач, а также сравнение производительности вычислений на JavaScript и WebAssembly.

## Технологический стек

- **Quasar Framework** — для создания пользовательского интерфейса на основе Vue.js.
- **Vite** — для быстрой сборки и разработки.
- **Pinia** — для управления состоянием приложения.
- **Web Workers** — для выполнения асинхронных задач в отдельных потоках.
- **WebAssembly (Rust)** — для высокопроизводительных вычислений.
- **Rust + wasm-pack** — для компиляции Rust-кода в WebAssembly.

## Установка и запуск

### Требования

- **Node.js** (версия 16 или выше)
- **Rust** и **wasm-pack** (для компиляции WebAssembly-модуля)
- **NPM** или **Yarn** для управления зависимостями

### Установка зависимостей

1. Склонируйте репозиторий:
   ```bash
   git clone <URL_репозитория>
   cd workers-pool
   ```

2. Установите зависимости проекта:
   ```bash
   npm install
   ```

Пункты 3-7 не обязательны и требуются для компиляции кода RUST.
В проект добавлен уже скомпилированный wasm модуль.

3. Установите Rust и wasm-pack (если еще не установлены):
   ```bash
   curl https://sh.rustup.rs -sSf | sh
   rustup target add wasm32-unknown-unknown
   cargo install wasm-pack
    ```

4. Создайте Rust Library
    ```bash
    cargo new factorial-wasm --lib
    cd factorial-wasm
    ```
5. Обновите Cargo.toml, включив в него зависимости для обработки больших чисел.
    ```toml
   [package]
   name = "factorial-wasm"
   version = "0.1.0"
   edition = "2021"

   [lib]
   crate-type = ["cdylib"]
   
   [dependencies]
   wasm-bindgen = "0.2"
   num-bigint = "0.4"
   num-traits = "0.2"
   ```
6. Напишите код Rust в src/lib.rs для вычисления факториала и возврата его в виде строки (поскольку JavaScript испытывает трудности с обработкой больших целых чисел):
    ```rust
    // factorial-wasm/src/lib.rs
    use num_bigint::BigUint;
    use num_traits::One;
    use wasm_bindgen::prelude::*;
    
    #[wasm_bindgen]
    pub fn factorial(n: u32) -> String {
        let mut result = BigUint::one();
        for i in 1..=n {
            result *= BigUint::from(i);
        }
        result.to_string()
    }
    ```

5. Скомпилируйте WebAssembly-модуль:
   ```bash
   cd factorial-wasm
   wasm-pack build --target web
   ```
   Скопируйте файлы `pkg/factorial_wasm.js` и `pkg/factorial_wasm_bg.wasm` в папку `src/workers/wasm/` вашего проекта.

### Запуск проекта

1. Запустите приложение в режиме разработки:
   ```bash
   npm run dev
   ```
   или, если используете Quasar CLI:
   ```bash
   quasar dev
   ```

2. Откройте приложение в браузере по адресу `http://localhost:9000` (порт может варьироваться).

## Использование

Приложение предоставляет три вкладки для взаимодействия с воркерами:

1. **HTTP**:
    - Введите IP/URL, порт, имя пользователя и пароль для выполнения HTTP-запроса.
    - Выберите метод (GET или POST). Для POST-запросов можно указать JSON-тело.
    - Нажмите «Отправить запрос» для выполнения запроса.
    - Результаты отображаются внизу с возможностью очистки.

2. **Compute (JS)**:
    - Введите число для вычисления его факториала (например, 1000).
    - Нажмите «Выполнить вычисление» для запуска задачи.
    - Результаты включают значение факториала и время выполнения.

3. **WASM Compute (Rust)**:
    - Аналогично Compute-воркеру, но использует WebAssembly.
    - Позволяет сравнить производительность вычислений на Rust (WASM) и JavaScript.

Каждая вкладка показывает статистику: количество задач в очереди, общее число воркеров и свободных воркеров. Иконка «info» открывает диалог с подробной статистикой по каждому типу воркеров.

## Структура проекта

- `src/pages/IndexPage.vue`: Основной компонент с пользовательским интерфейсом, содержащий вкладки и формы для взаимодействия с воркерами.
- `src/stores/workerStore.js`: Pinia-магазин для управления состоянием воркеров, результатов и статистики.
- `src/workers/`:
    - `httpWorker.js`: Web Worker для HTTP-запросов.
    - `computeWorker.js`: Web Worker для вычислений факториала на JavaScript.
    - `rustComputeWorker.js`: Web Worker для вычислений факториала с использованием WebAssembly.
    - `workerManager.js`: Класс для управления пулом воркеров и очередями задач.
    - `wasm/`: Папка с скомпилированными файлами WebAssembly (`factorial_wasm.js`, `factorial_wasm_bg.wasm`).
- `factorial-wasm/`: Отдельный Rust-проект для компиляции WebAssembly-модуля.

## Примечания

- **Производительность**: WASM Compute-воркер (Rust) обычно быстрее JS Compute-воркера для больших чисел благодаря оптимизациям Rust и компиляции в WebAssembly. Время выполнения отображается в результатах для сравнения.
- **Ограничения**: HTTP-воркер требует корректных учетных данных и доступного API. Убедитесь, что целевой сервер поддерживает CORS для браузерных запросов.
- **Расширяемость**: Пул воркеров можно расширить, добавив новые типы воркеров в `workerStore.js` и `workerManager.js`.

## Лицензия

Проект распространяется под лицензией MIT. См. файл `LICENSE` для подробностей.